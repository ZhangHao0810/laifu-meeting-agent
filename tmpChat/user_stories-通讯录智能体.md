# 通讯录智能体 - 用户故事

基于 `new-contacts` MCP Server 的 6 个工具能力，以下是用户如何使用通讯录智能体的典型场景。

## 📑 目录

- [👤 场景一：个人信息查询](#-场景一个人信息查询)
  - [用户故事 1.1：查看自己的详细信息](#用户故事-11查看自己的详细信息)
  - [用户故事 1.2：根据姓名查找同事](#用户故事-12根据姓名查找同事)
  - [用户故事 1.3：模糊搜索员工](#用户故事-13模糊搜索员工)
- [🏢 场景二：部门人员查询](#-场景二部门人员查询)
  - [用户故事 2.1：查询部门在特定城市的同事](#用户故事-21查询部门在特定城市的同事)
  - [用户故事 2.2：获取部门人员名单](#用户故事-22获取部门人员名单)
  - [用户故事 2.3：查询部门详细信息](#用户故事-23查询部门详细信息)
- [📞 场景三：批量信息查询](#-场景三批量信息查询)
  - [用户故事 3.1：批量查询员工联系方式](#用户故事-31批量查询员工联系方式)
  - [用户故事 3.2：获取会议参会人详细信息](#用户故事-32获取会议参会人详细信息)
- [🔗 场景四：与会议系统联动](#-场景四与会议系统联动)
  - [用户故事 4.1：根据部门和城市自动邀请参会人](#用户故事-41根据部门和城市自动邀请参会人)
  - [用户故事 4.2：查询会议参会人的联系方式](#用户故事-42查询会议参会人的联系方式)
- [📝 使用工具映射表](#-使用工具映射表)
- [💡 智能体核心能力总结](#-智能体核心能力总结)

---

## 👤 场景一：个人信息查询

### 用户故事 1.1：查看自己的详细信息
**作为** 员工  
**我想要** 查看我的详细个人信息  
**以便** 确认我的工号、邮箱、电话等信息是否正确

**对话示例：**
> **用户**："我是王星，我的个人详细信息是什么？越详细越好。"

**智能体行为：**
1. 使用 `getUserByName` 根据姓名"王星"查询，获取工号
2. 使用 `getCloudUserInfo` 根据工号查询完整的个人信息
3. 展示包括工号、姓名、邮箱、电话、部门路径、BASE地、IM_OPEN_ID 等所有字段

---

### 用户故事 1.2：根据姓名查找同事
**作为** 员工  
**我想要** 根据同事的姓名查找他的联系方式  
**以便** 能够联系到他

**对话示例：**
> **用户**："帮我找一下孙薇洁的联系方式。"

**智能体行为：**
1. 使用 `getUserByName` 精确查询"孙薇洁"
2. 返回姓名、工号、电话、邮箱、部门等基本信息
3. 如果有多个同名员工，列出所有匹配结果供用户选择

---

### 用户故事 1.3：模糊搜索员工
**作为** 员工  
**我想要** 通过部分姓名或拼音搜索员工  
**以便** 在不确定全名时也能找到同事

**对话示例：**
> **用户**："帮我找一下姓王的同事，在AI部门的。"

**智能体行为：**
1. 使用 `searchUsersByName` 搜索关键词"王"
2. 筛选部门路径包含"AI"的员工
3. 返回匹配的员工列表（姓名、工号、部门、BASE地）

---

## 🏢 场景二：部门人员查询

### 用户故事 2.1：查询部门在特定城市的同事
**作为** 部门主管  
**我想要** 查询我部门在某个城市办公的所有同事  
**以便** 组织本地活动或会议

**对话示例：**
> **用户**："我是王星，我部门都有哪些同事在深圳办公？"

**智能体行为：**
1. 使用 `getUserByName` 查询"王星"，获取其部门信息
2. 使用 `getDepartmentMembers` 查询该部门成员，并过滤 `baseNames: ["深圳市"]`
3. 返回深圳办公的同事列表（姓名、工号、电话等）

---

### 用户故事 2.2：获取部门人员名单
**作为** 行政人员  
**我想要** 获取某个部门的完整人员名单  
**以便** 进行人员统计或发送通知

**对话示例：**
> **用户**："给我测试部在深圳的人员名单。"

**智能体行为：**
1. 使用 `getDepartmentMembers` 查询"测试部"，过滤 `baseNames: ["深圳市"]`
2. 返回符合条件的员工列表
3. 展示总人数和详细名单

---

### 用户故事 2.3：查询部门详细信息
**作为** 新员工  
**我想要** 了解某个部门的详细信息  
**以便** 了解部门结构和成员组成

**对话示例：**
> **用户**："AI产品研发中心有多少人？都有谁？"

**智能体行为：**
1. 使用 `getDepartmentInfo` 查询"AI产品研发中心"
2. 返回部门的基本信息（部门ID、名称、路径、成员数量）
3. 展示部门成员列表（可选择是否展示全部成员）

---

## 📞 场景三：批量信息查询

### 用户故事 3.1：批量查询员工联系方式
**作为** 项目经理  
**我想要** 批量查询多个员工的联系方式  
**以便** 快速建立项目组通讯录

**对话示例：**
> **用户**："帮我查一下工号 11528、11529、11530 这几个人的电话和邮箱。"

**智能体行为：**
1. 使用 `getBatchUserInfo` 批量查询这些工号
2. 指定返回字段 `fields: ["CODE", "NAME", "PHONE", "EMAIL"]`
3. 返回精简的联系方式列表

---

### 用户故事 3.2：获取会议参会人详细信息
**作为** 会议组织者  
**我想要** 查看会议参会人的详细信息  
**以便** 了解参会人的部门和联系方式

**对话示例：**
> **用户**："查看明天上午会议的所有参会人信息，包括他们的部门和电话。"

**智能体行为：**
1. 从会议系统获取参会人的工号列表
2. 使用 `getBatchUserInfo` 批量查询参会人信息
3. 返回参会人的姓名、部门、电话、邮箱等信息

---

## 🔗 场景四：与会议系统联动

### 用户故事 4.1：根据部门和城市自动邀请参会人
**作为** 会议组织者  
**我想要** 自动邀请某部门在特定城市的所有同事参会  
**以便** 快速组织跨地域会议

**对话示例：**
> **用户**："我是王星，下周三上午帮我约个AI部产品测试季度汇报会，把所有测试部门在深圳的同事都叫上。"

**智能体行为：**
1. 使用 `getDepartmentMembers` 查询"测试部"，过滤 `baseNames: ["深圳市"]`
2. 获取所有符合条件的员工工号（CODE）或 IM_OPEN_ID
3. 使用会议系统的 `createMeeting` 工具创建会议，并将这些员工添加为参会人
4. 确认会议创建成功并告知邀请的人数

---

### 用户故事 4.2：查询会议参会人的联系方式
**作为** 会议组织者  
**我想要** 查看某个会议所有参会人的联系方式  
**以便** 在会议前进行电话确认

**对话示例：**
> **用户**："查看今天下午3点到5点的全部会议，并展示会议室的与会人联系方式。"

**智能体行为：**
1. 使用会议系统的 `queryMeetingsByRange` 查询下午3-5点的会议
2. 对每个会议使用 `getMeetingRoomAttendees` 获取参会人的 openId 或工号
3. 使用 `getBatchUserInfo` 批量查询参会人的详细信息
4. 展示会议信息及参会人的姓名、电话、邮箱等

---

## 📝 使用工具映射表

| 用户场景 | 使用的 MCP 工具 |
|---------|----------------|
| 根据工号查询员工 | `getCloudUserInfo` |
| 根据姓名查询员工 | `getUserByName` |
| 模糊搜索员工 | `searchUsersByName` |
| 批量查询员工 | `getBatchUserInfo` |
| 查询部门信息 | `getDepartmentInfo` |
| 查询部门成员（推荐） | `getDepartmentMembers` |

---

## 💡 智能体核心能力总结

基于 6 个 MCP 工具，通讯录智能体能够提供：

1. **多维度查询**：支持按工号、姓名、关键词等多种方式查询员工
2. **精准过滤**：支持按部门、城市（BASE地）等条件过滤员工
3. **批量操作**：支持批量查询多个员工信息，减少调用次数
4. **智能推荐**：🌟 推荐使用 `getDepartmentMembers` 工具，一次调用即可获得过滤后的精确结果，减少 99% 上下文占用
5. **与会议系统联动**：可以根据部门和城市自动邀请参会人，实现智能化会议组织
6. **字段选择**：支持只返回需要的字段，减少数据传输量

---

## 🎯 工具使用建议

### 推荐使用 `getDepartmentMembers`

当需要查询部门成员时，**强烈推荐**使用 `getDepartmentMembers` 而不是 `getDepartmentInfo` + `getBatchUserInfo` 的组合：

| 维度 | 旧方案 | 新方案 (getDepartmentMembers) |
|------|--------|------------------------------|
| 调用次数 | 2 次 | 1 次 |
| 返回数据量 | ~134KB | ~1KB |
| 上下文占用 | 高 | **减少 99%** |
| 过滤能力 | 需要 AI 自己过滤 | 直接获得过滤结果 |

**示例对比：**

❌ **不推荐的方式：**
```
1. getDepartmentInfo(orgName: "AI产品研发中心") 
   → 返回 146 个成员的工号
2. getBatchUserInfo(codes: [146个工号])
   → 返回 146 个完整员工对象 (~134KB)
3. AI 自己过滤出深圳的员工
```

✅ **推荐的方式：**
```
1. getDepartmentMembers(
     orgName: "AI产品研发中心",
     filters: { baseNames: ["深圳市"] },
     fields: ["CODE", "NAME", "PHONE", "EMAIL"]
   )
   → 直接返回 8 个深圳员工的精简信息 (~1KB)
```

---

> [!TIP]
> 这些用户故事覆盖了 `new-contacts` MCP Server 提供的所有 6 个工具能力，可以与会议系统智能体配合使用，实现更强大的协同功能。
