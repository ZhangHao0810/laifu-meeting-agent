# 会议室预定接口文档

## 目录

1. [接口：是否有新增会议预定](#接口是否有新增会议预定)
2. [接口：获取该时间点之后的会议室预定信息](#接口获取该时间点之后的会议室预定信息)
3. [接口：查询该工作空间的可用会议室（空闲会议室）](#接口查询该工作空间的可用会议室空闲会议室)
4. [接口：查询某个会议的与会人（参会人员列表）](#接口查询某个会议的与会人参会人员列表)

---

## 接口：是否有新增会议预定

**接口用途**  
用于轮询判断是否有新会议预定，减少不必要的全量查询。

**请求方法**：POST  
**请求地址**：  
`https://lim.zhongfu.net/api/roomBook/third/hasNew?accessToken={token}`

**Content-Type**：`application/json`

### 请求参数（Body）

| 字段 | 类型 | 必填 | 说明 | 示例值 |
|------|------|------|------|--------|
| eid | string | 是 | 企业/团队ID（固定值） | "25185534" |
| lastTime | string | 否 | 上次更新时间戳（毫秒字符串） | "17702460000000" |

> [!TIP]
> **lastTime 使用建议**：判断此时间之后是否有新增/变更的预定。建议从 `/bookInfo` 接口的 `updateTime` 取最新值作为 `lastTime`。

**请求示例**

```json
{
  "eid": "25185534",
  "lastTime": "17702460000000"
}
```

### 响应示例（成功）

```json
{
  "data": {
    "hasNew": true
  },
  "error": "正确访问",
  "errorCode": 200,
  "success": true
}
```

### 响应字段说明

| 字段 | 含义 | 示例值 | 备注 |
|------|------|--------|------|
| hasNew | 是否有新增或变更 | true | true=有新增/变更, false=无变化 |
| errorCode | 状态码 | 200 | 200=正常 |
| success | 是否成功 | true | |
| error | 错误信息 | "正确访问" | |

### 常见状态与处理

- `hasNew: true` → 有新增或变更，需要调用其他接口获取详情
- `hasNew: false` → 无变化，无需查询
- `errorCode: 200` → 请求成功
- `success: true` → 接口调用成功

---

## 接口：获取该时间点之后的会议室预定信息

**接口用途**  
增量拉取会议室预定变更，结合 `hasNew` 接口使用，实现实时同步。

**请求方法**：POST  
**请求地址**：  
`https://lim.zhongfu.net/api/roomBook/third/bookInfo?accessToken={token}`

**Content-Type**：`application/json`

### 请求参数（Body）

| 字段 | 类型 | 必填 | 说明 | 示例值 |
|------|------|------|------|--------|
| eid | string | 是 | 企业/团队ID（固定值） | "25185534" |
| lastIndex | string | 否 | 最后一条的 updateTime（时间戳），用于增量获取 | "1770277461483" |
| pageSize | integer | 否 | 分页大小，默认50，最大50 | 50 |

> [!TIP]
> **lastIndex 使用建议**：用于增量获取（上次拉取的最大 `updateTime`），不传返回所有预定。建议保存上次响应中最大的 `updateTime` 作为下次请求的 `lastIndex`。

**请求示例**

```json
{
  "eid": "25185534",
  "lastIndex": "1770277461483",
  "pageSize": 50
}
```

### 响应示例（成功）

```json
{
  "data": {
    "add": [
      {
        "eid": "25185534",
        "orderId": "69844a4742e6e00019e2746",
        "updateTime": "1770277665950",
        "oid": "64db4378e4b05e2064aa2346",
        "userName": "徐海峰",
        "meetingTopic": "项目讨论",
        "roomId": "64df1e9b438a1e000194c496",
        "roomName": "北京临时会议室 (可开视频会议)",
        "roomDetail": "北京公司内",
        "createTime": "1770277665182",
        "approve": "2",
        "startTime": "1770277580000",
        "endTime": "1770283800000",
        "day": "2026-02-05"
      }
    ],
    "delete": []
  },
  "error": "正确访问",
  "errorCode": 200,
  "success": true
}
```

### 响应字段说明

#### 核心字段（add 数组中的会议预定对象）

| 字段 | 含义 | 示例值 | 备注 |
|------|------|--------|------|
| **orderId** | **订单ID** | "69844a4742e6e00019e2746" | ⭐ 唯一标识 |
| **updateTime** | **更新时间戳** | "1770277665950" | ⭐ 用于下次 lastIndex |
| **userName** | **预定人** | "徐海峰" | ⭐ 会议预定者姓名 |
| **meetingTopic** | **会议主题** | "项目讨论" | ⭐ 会议标题 |
| **roomName** | **会议室名称** | "北京临时会议室 (可开视频会议)" | ⭐ 完整会议室名称 |
| **startTime** | **开始时间** | "1770277580000" | ⭐ 时间戳（毫秒） |
| **endTime** | **结束时间** | "1770283800000" | ⭐ 时间戳（毫秒） |
| **day** | **日期** | "2026-02-05" | ⭐ yyyy-MM-dd 格式 |

#### 其他字段

| 字段 | 含义 | 示例值 | 备注 |
|------|------|--------|------|
| eid | 企业ID | "25185534" | |
| oid | 预定人OpenID | "64db4378e4b05e2064aa2346" | |
| roomId | 会议室ID | "64df1e9b438a1e000194c496" | |
| roomDetail | 会议室详情 | "北京公司内" | |
| createTime | 创建时间戳 | "1770277665182" | |
| approve | 审批状态 | "2" | 1=待审批, 2=已通过 |

#### 响应结构字段

| 字段 | 含义 | 说明 |
|------|------|------|
| data.add | 新增/变更的预定 | 数组，包含新增或修改的会议预定 |
| data.delete | 删除的预定 | 数组，包含已删除的会议预定 |
| errorCode | 状态码 | 200=正常 |
| success | 是否成功 | true/false |

### 常见状态与处理

- `data.add` 不为空 → 有新增或变更的会议预定，需要处理
- `data.delete` 不为空 → 有删除的会议预定，需要移除
- 保存最大的 `updateTime` → 作为下次请求的 `lastIndex`
- `errorCode: 200` → 请求成功
- `pageSize` 最大50 → 如果数据量大，需要多次请求

---

## 接口：查询该工作空间的可用会议室（空闲会议室）

**接口用途**  
用于预约前查询某个时间段内，当前用户工作空间可见的空闲会议室列表。

**请求方法**：POST  
**请求地址**：  
`https://lim.zhongfu.net/api/roomBook/third/freeRooms?accessToken={token}`

**Content-Type**：`application/json`

### 请求参数（Body）

| 字段 | 类型 | 必填 | 说明 | 示例值 |
|------|------|------|------|--------|
| openId | string | 是 | 预约人员 openId (IM_OPEN_ID) | "64db4447e4b00d5d7f029ee2" |
| startTime | long | 是 | 开始时间戳（毫秒） | 17702724600000 |
| endTime | long | 是 | 结束时间戳（毫秒），不填查全天 | null |
| pageIndex | integer | 否 | 页码，默认1 | 1 |
| pageSize | integer | 否 | 每页条数，默认50 | 50 |

> [!TIP]
> **使用建议**：
> - `openId` 用于判断该用户可见/可预约的会议室范围
> - `startTime`、`endTime` 必须传，用于筛选该时间段内空闲的会议室

**请求示例**

```json
{
  "openId": "64db4447e4b00d5d7f029ee2",
  "startTime": 17702724600000,
  "endTime": 17702724800000,
  "pageIndex": 1,
  "pageSize": 50
}
```

### 响应示例（成功）

```json
{
  "data": [
    {
      "roomId": "644de8fd2e340001db9acc",
      "roomName": "广州商点会议室(可开视频会议)",
      "roomDetail": "广州小蛮腰大厦 3-1室",
      "tagId": "644de545438a1e000194c02a",
      "limitCount": 16,
      "approve": true,
      "layoutImg": null,
      "businessList": null
    },
    {
      "roomId": "644dfdd4f2e3400019d4de8",
      "roomName": "济南舜泰广场会议室",
      "roomDetail": "济南舜泰广场 2001室",
      "limitCount": 10,
      "approve": true
    }
  ],
  "error": "正确访问",
  "errorCode": 200,
  "success": true
}
```

### 响应字段说明

#### 核心字段（data 数组中的会议室对象）

| 字段 | 含义 | 示例值 | 备注 |
|------|------|--------|------|
| **roomId** | **会议室ID** | "644de8fd2e340001db9acc" | ⭐ 唯一标识 |
| **roomName** | **会议室名称** | "广州商点会议室(可开视频会议)" | ⭐ 完整名称 |
| **roomDetail** | **位置描述** | "广州小蛮腰大厦 3-1室" | ⭐ 楼层/位置信息 |
| **limitCount** | **容纳人数** | 16 | ⭐ 最大可容纳人数 |
| **approve** | **是否需要审批** | true | ⭐ true=需要审批, false=直接预约 |


#### 响应结构字段

| 字段 | 含义 | 说明 |
|------|------|------|
| data | 空闲会议室列表 | 数组，包含所有符合条件的空闲会议室 |
| errorCode | 状态码 | 200=正常 |
| success | 是否成功 | true/false |
| error | 错误信息 | "正确访问" |

### 常见状态与处理

- `data` 为空数组 → 该时间段无可用会议室
- `data` 不为空 → 返回可预约的会议室列表
- `approve: true` → 该会议室需要审批才能预约
- `approve: false` → 该会议室可直接预约
- `errorCode: 200` → 请求成功

---

## 接口：查询某个会议的与会人（参会人员列表）

**接口用途**  
根据会议订单ID查询该会议的所有与会人员列表，包括姓名、openId 和头像链接。常用于会议详情页显示"参会人"列表。

**请求方法**：POST  
**请求地址**：  
`https://lim.zhongfu.net/api/roomBook/third/getActors?accessToken={token}`

**Content-Type**：`application/json`

### 请求参数（Body）

| 字段 | 类型 | 必填 | 说明 | 示例值 |
|------|------|------|------|--------|
| orderId | string | 是 | 会议订单ID (roomOrderId) | "697c26b242e6e0009e0319" |

**请求示例**

```json
{
  "orderId": "697c26b242e6e0009e0319"
}
```

### 响应示例（成功）

```json
{
  "data": [
    {
      "openId": "644b417ae4b00d5d7f028c43",
      "headerUrl": "https://lim.zhongfu.net/space/c/photo/load?id=1d21633a6b92000173957",
      "userName": "彭祥海"
    },
    {
      "openId": "644b4447e4b00d5d7f029ee2",
      "headerUrl": "https://lim.zhongfu.net/space/c/photo/load?id=2e2e76069191000101260",
      "userName": "张浩"
    },
    {
      "openId": "644b421fe4b00d5d7f029745",
      "headerUrl": "https://lim.zhongfu.net/space/c/photo/load?id=4ff2f8377e84f8001252d4f",
      "userName": "卢科"
    },
    {
      "openId": "644b415fe4b00d5d7f028a0c",
      "headerUrl": "https://lim.zhongfu.net/space/c/photo/load?id=1e35efc2a797000171747",
      "userName": "孙琦"
    },
    {
      "openId": "644b43f4e4b05e2004aa45a",
      "headerUrl": "https://lim.zhongfu.net/space/c/photo/load?id=32fdb93b691900193c7",
      "userName": "路冰"
    },
    {
      "openId": "644b442de4b00d5d7f029e9",
      "headerUrl": "https://lim.zhongfu.net/space/c/photo/load?id=3556761ecc800016eccf",
      "userName": "张建彬"
    },
    {
      "openId": "644b424e4b00d5d7f0291ff",
      "headerUrl": "https://lim.zhongfu.net/space/c/photo/load?id=376564b6b91000192072",
      "userName": "刘长秋"
    }
  ],
  "error": "success",
  "errorCode": 200,
  "success": true
}
```

### 响应字段说明

#### 核心字段（data 数组中的参会人对象）

| 字段 | 含义 | 示例值 | 备注 |
|------|------|--------|------|
| **openId** | **用户唯一标识** | "644b417ae4b00d5d7f028c43" | ⭐ IM openId |
| **userName** | **参会人姓名** | "彭祥海" | ⭐ 用户姓名 |

#### 响应结构字段

| 字段 | 含义 | 说明 |
|------|------|------|
| data | 参会人员列表 | 数组，包含所有与会人员信息 |
| errorCode | 状态码 | 200=正常 |
| success | 是否成功 | true/false |
| error | 错误信息 | "success" |

### 常见状态与处理

- `data` 为空数组 → 该会议暂无参会人员
- `data` 不为空 → 返回参会人员列表
- `errorCode: 200` → 请求成功

---

**文档更新时间**: 2026-02-05